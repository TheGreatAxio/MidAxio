<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Verifying Account - MidAxio</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<nav class="global-nav"></nav>
<aside class="side-sidebar"></aside>

<main class="main-container">
    <div class="auth-container">
        <h1 id="statusHeader">Verifying Your Account</h1>
        <p id="statusMessage">Please wait while we confirm your email...</p>
        <div id="loader" style="margin: 20px auto; border: 4px solid #333; border-top: 4px solid #4169e1; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite;"></div>
    </div>
</main>

<footer class="ad-footer"></footer>

<script src="js/script.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', async () => {
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('token');
        const header = document.getElementById('statusHeader');
        const msg = document.getElementById('statusMessage');
        const loader = document.getElementById('loader');

        if (!token) {
            header.innerText = "Invalid Link";
            msg.innerText = "No verification token found.";
            loader.style.display = 'none';
            return;
        }

        try {
            const response = await fetch(`https://api.axioscomputers.com/api/v1/auth/verify?token=${token}`);
            const data = await response.json();

            if (response.ok) {
                header.innerText = "Success!";
                header.style.color = "lightgreen";
                msg.innerText = "Account verified! Redirecting to login...";
                loader.style.display = 'none';

                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 3000);
            } else {
                header.innerText = "Verification Failed";
                header.style.color = "red";
                msg.innerText = data.message || "The link may be expired or invalid.";
                loader.style.display = 'none';
            }
        } catch (err) {
            header.innerText = "Server Error";
            msg.innerText = "Could not connect to the verification server.";
            loader.style.display = 'none';
        }
    });
</script>
<style>
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
</style>
</body>
</html>